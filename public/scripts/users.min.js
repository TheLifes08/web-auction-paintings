"use strict";function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0,t=function(){};return{s:t,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,n=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw n}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function createTableRow(e){var t=document.createElement("tr"),r=document.createElement("td"),a=document.createElement("td"),n=document.createElement("td"),o=document.createElement("td"),s=document.createElement("td"),c=document.createElement("button"),u=document.createElement("img");return r.append(document.createTextNode(e.id)),a.append(document.createTextNode(e.name)),n.append(document.createTextNode(e.balance)),o.append(document.createTextNode(e.participate?"Да":"Нет")),s.append(c),c.append(u),r.classList.add("w3-right-align"),n.classList.add("w3-center"),o.classList.add("w3-center"),c.classList.add("w3-button","w3-circle","settings-button","w3-right"),c.onclick=function(){openUpdateForm(e.id)},u.classList.add("settings-button-icon"),u.src="/public/images/settings.png",t.append(r,a,n,o,s),t}function updateTable(){$.get("/storage/users").done(function(e){if(e){var t=$("#users-table-body");t.empty();var r,a=_createForOfIteratorHelper(e);try{for(a.s();!(r=a.n()).done;){var n=createTableRow(r.value);t.append(n)}}catch(e){a.e(e)}finally{a.f()}}})}function openUpdateForm(e){$.get("/storage/users/"+e).done(function(r){r&&($("#update-user-form-balance").val(r.balance),$("#update-user-form-participate").prop("checked",r.participate),$("#update-user-form-submit").off("click"),$("#update-user-form-submit").on("click",function(){var e=$("#update-user-form-balance").val(),t=$("#update-user-form-participate").is(":checked");updateUser({id:r.id,balance:e,participate:t})}),$("#modal-update-user").css("display","block"))})}function closeUpdateForm(){$("#modal-update-user").css("display","none"),$("#update-user-form-message").css("display","none")}function updateUser(e){$.ajax({url:"/storage/users/",type:"PUT",data:e,success:function(e){e&&(showMessage(e.message,e.error),e.error||(console.log(e),updateTable()))}})}function showMessage(e,t){var r=$("#update-user-form-message");$("#update-user-form-message-p").text(e),t?(r.addClass("w3-red"),r.removeClass("w3-green")):(r.addClass("w3-green"),r.removeClass("w3-red")),r.css("display","block")}$(document).ready(function(){updateTable(),$("#update-user-form-message-close").on("click",function(){$("#update-user-form-message").css("display","none")})});